{"version":3,"names":["_zegoUikitRn","_interopRequireWildcard","require","_logger","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_appInfo","_localUser","_pluginConnectionState","ZIMKitPlugin","_install","plugins","ZegoUIKit","installPlugins","forEach","plugin","ZIMKit","zloginfo","getModuleName","temp","ZegoPrebuiltPlugins","init","appID","appSign","userID","userName","callbackID","String","Math","floor","random","getPlugin","ZegoUIKitPluginType","signaling","getSignalingPlugin","onConnectionStateChanged","_ref","state","login","then","Promise","resolve","joinRoom","roomID","reconnectIfDisconnected","ZegoInvitationConnectionState","disconnected","logout","uninit","getLocalUser","getAppInfo","getZIMKitPlugin","_default","exports"],"sources":["plugins.ts"],"sourcesContent":["import ZegoUIKit, {\n  ZegoUIKitPluginType,\n  ZegoInvitationConnectionState,\n} from '@zegocloud/zego-uikit-rn';\nimport { zloginfo } from '../utils/logger';\n\nconst _appInfo = {} as any;\nconst _localUser = {} as any;\nlet _pluginConnectionState: number;\nlet ZIMKitPlugin: any = null;\nconst _install = (plugins: any[]) => {\n  ZegoUIKit.installPlugins(plugins);\n  plugins.forEach(plugin => {\n    if (plugin.ZIMKit) {\n      zloginfo('[Plugins] install ZIMKit success.');\n      ZIMKitPlugin = plugin;\n    } else if (plugin.default && typeof plugin.default.getModuleName === 'function') {\n      const temp = plugin.default.getModuleName();\n      if (temp === 'ZIMKit') {\n        zloginfo('[Plugins] install ZIMKit success.');\n        ZIMKitPlugin = plugin;\n      }\n    }\n  })\n};\n\nconst ZegoPrebuiltPlugins = {\n  init: (appID: number, appSign: string, userID: string, userName: string, plugins: any[]) => {\n    const callbackID =\n      'ZegoPrebuiltPlugins' + String(Math.floor(Math.random() * 10000));\n    _install(plugins);\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      ZegoUIKit.getSignalingPlugin().init(appID, appSign);\n      ZegoUIKit.getSignalingPlugin().onConnectionStateChanged(\n        callbackID,\n        ({ state }: any) => {\n          _pluginConnectionState = state;\n        }\n      );\n      _appInfo.appID = appID;\n      _appInfo.appSign = appSign;\n      _localUser.userID = userID;\n      _localUser.userName = userName;\n      return ZegoUIKit.getSignalingPlugin().login(userID, userName).then(() => {\n        zloginfo('[Plugins] login success.');\n        return true;\n      });\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n      return Promise.resolve(false);\n    }\n  },\n  joinRoom(roomID: string) {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      return ZegoUIKit.getSignalingPlugin().joinRoom(roomID).then(() => {\n        zloginfo('[Plugins] join room success.');\n        return true;\n      });\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n      return Promise.resolve(false);\n    }\n  },\n  reconnectIfDisconnected: () => {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      zloginfo(\n        '[Plugins] reconnectIfDisconnected',\n        _pluginConnectionState,\n        ZegoInvitationConnectionState.disconnected\n      );\n      if (_pluginConnectionState === ZegoInvitationConnectionState.disconnected) {\n        ZegoUIKit.getSignalingPlugin().logout().then(() => {\n          zloginfo('[Plugins] auto logout success.');\n          ZegoUIKit.getSignalingPlugin().login(\n            _localUser.userID,\n            _localUser.userName\n          ).then(() => {\n            zloginfo('[Plugins] auto reconnect success.');\n          });\n        });\n      }\n    } else {\n      zloginfo('[Plugins]The signal plugin passed in is empty');\n    }\n  },\n  uninit: () => {\n    if (ZegoUIKit.getPlugin(ZegoUIKitPluginType.signaling)) {\n      ZegoUIKit.getSignalingPlugin().logout();\n      ZegoUIKit.getSignalingPlugin().uninit();\n    }\n  },\n  getLocalUser: () => {\n    return _localUser;\n  },\n  getAppInfo: () => {\n    return _appInfo;\n  },\n  getZIMKitPlugin: () => {\n    return ZIMKitPlugin;\n  }\n};\n\nexport default ZegoPrebuiltPlugins;\n"],"mappings":"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"}