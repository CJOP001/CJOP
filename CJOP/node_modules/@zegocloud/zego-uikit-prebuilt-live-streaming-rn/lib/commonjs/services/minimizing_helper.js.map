{"version":3,"names":["_zegoUikitRn","_interopRequireDefault","require","_prebuilt_helper","_class","obj","__esModule","default","_defineProperty","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","MinimizingHelper","constructor","getInstance","_instance","getIsMinimize","_isMinimize","setIsMinimizeSwitch","isMinimizeSwitch","_isMinimizeSwitch","getIsMinimizeSwitch","setInitParams","appID","appSign","userID","userName","roomID","config","arguments","length","_appInfo","_localUser","_roomID","assign","_config","getInitAppInfo","getInitUser","getInitRoomID","getInitConfig","getInitPlugins","_plugins","minimizeWindow","callbackID","Math","floor","random","unRegisterAudioVideoListCallback","registerAudioVideoListCallback","notifyMinimize","startUpdateTimer","updateActiveUserIDByTimer","initUpdateTimer","clearInterval","_updateTimer","activeUserID","PrebuiltHelper","getRealTimeData","hostID","_activeUserID","ZegoUIKit","getLocalUserInfo","notifyActiveUserIDUpdate","notifyPrebuiltInit","keys","_onPrebuiltInitCallbackMap","forEach","_onActiveUserIDUpdateCallbackMap","_onWindowMinimizeCallbackMap","notifyMaximize","_onWindowMaximizeCallbackMap","notifyEntryNormal","_onEntryNormalCallbackMap","onPrebuiltInit","callback","onActiveUserIDUpdate","onWindowMinimized","onWindowMaximized","onEntryNormal","exports"],"sources":["minimizing_helper.ts"],"sourcesContent":["import ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport PrebuiltHelper from \"./prebuilt_helper\";\n\nexport default class MinimizingHelper {\n    static _instance: MinimizingHelper;\n    _isMinimize = false;\n    _isMinimizeSwitch = false;\n    _activeUserID = '';\n    _onActiveUserIDUpdateCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onWindowMinimizeCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onWindowMaximizeCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onEntryNormalCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _updateTimer: null | NodeJS.Timeout = null;\n    _appInfo: {\n        appID?: number;\n        appSign?: String;\n    } = {};\n    _localUser: {\n        userID?: string;\n        userName?: string;\n    } = {};\n    _roomID = '';\n    _config: any = {};\n    _plugins: any[] = [];\n    _onPrebuiltInitCallbackMap: { [index: string]: (data?: any) => void } = {};\n    constructor() { }\n    static getInstance() {\n        return this._instance || (this._instance = new MinimizingHelper());\n    }\n    getIsMinimize() {\n        return this._isMinimize;\n    }\n    setIsMinimizeSwitch(isMinimizeSwitch: boolean) {\n        this._isMinimizeSwitch = !!isMinimizeSwitch;\n    }\n    getIsMinimizeSwitch() {\n        return this._isMinimizeSwitch;\n    }\n    setInitParams(appID: number, appSign: string, userID: string, userName: string, roomID: string, config = {}) {\n        this._appInfo = { appID, appSign };\n        this._localUser = { userID, userName };\n        this._roomID = roomID;\n        Object.assign(this._config, config);\n    }\n    getInitAppInfo() {\n        return this._appInfo;\n    }\n    getInitUser() {\n        return this._localUser;\n    }\n    getInitRoomID() {\n        return this._roomID;\n    }\n    getInitConfig() {\n        return this._config;\n    }\n    getInitPlugins() {\n        return this._plugins;\n    }\n    minimizeWindow() {\n        const callbackID = 'MinimizingHelper' + String(Math.floor(Math.random() * 10000));\n        this.unRegisterAudioVideoListCallback(callbackID);\n        this.registerAudioVideoListCallback(callbackID);\n\n        this.notifyMinimize();\n        this.startUpdateTimer();\n    }\n    startUpdateTimer() {\n        this.updateActiveUserIDByTimer();\n\n        this.initUpdateTimer();\n    }\n    initUpdateTimer() {\n        clearInterval(this._updateTimer);\n        this._updateTimer = null;\n    }\n    updateActiveUserIDByTimer() {\n        const activeUserID = PrebuiltHelper.getInstance().getRealTimeData().hostID;\n        this._activeUserID = activeUserID|| ZegoUIKit.getLocalUserInfo().userID || '';\n        \n        // console.log('[MinimizingHelper]updateActiveUserIDByTimer', this._activeUserID);\n        this.notifyActiveUserIDUpdate(this._activeUserID);\n    }\n    registerAudioVideoListCallback(callbackID: string) {\n    }\n    unRegisterAudioVideoListCallback(callbackID: string) {\n    }\n    notifyPrebuiltInit() {\n        Object.keys(this._onPrebuiltInitCallbackMap).forEach((callbackID) => {\n            if (this._onPrebuiltInitCallbackMap[callbackID]) {\n                this._onPrebuiltInitCallbackMap[callbackID]();\n            }\n        });\n    }\n    notifyActiveUserIDUpdate(activeUserID: string) {\n        Object.keys(this._onActiveUserIDUpdateCallbackMap).forEach((callbackID) => {\n            if (this._onActiveUserIDUpdateCallbackMap[callbackID]) {\n                this._onActiveUserIDUpdateCallbackMap[callbackID](activeUserID);\n            }\n        })\n    }\n    notifyMinimize() {\n        this._isMinimize = true;\n\n        Object.keys(this._onWindowMinimizeCallbackMap).forEach((callbackID) => {\n            if (this._onWindowMinimizeCallbackMap[callbackID]) {\n                this._onWindowMinimizeCallbackMap[callbackID]();\n            }\n        })\n    }\n    notifyMaximize() {\n        this._isMinimize = false;\n\n        Object.keys(this._onWindowMaximizeCallbackMap).forEach((callbackID) => {\n            if (this._onWindowMaximizeCallbackMap[callbackID]) {\n                this._onWindowMaximizeCallbackMap[callbackID]();\n            }\n        })\n    }\n    notifyEntryNormal() {\n        this._isMinimize = false;\n\n        Object.keys(this._onEntryNormalCallbackMap).forEach((callbackID) => {\n            if (this._onEntryNormalCallbackMap[callbackID]) {\n                this._onEntryNormalCallbackMap[callbackID]();\n            }\n        })\n    }\n    onPrebuiltInit(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onPrebuiltInitCallbackMap[callbackID];\n        } else {\n            this._onPrebuiltInitCallbackMap[callbackID] = callback;\n        }\n    }\n    onActiveUserIDUpdate(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onActiveUserIDUpdateCallbackMap[callbackID];\n        } else {\n            this._onActiveUserIDUpdateCallbackMap[callbackID] = callback;\n        }\n    }\n    onWindowMinimized(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onWindowMinimizeCallbackMap[callbackID];\n        } else {\n            this._onWindowMinimizeCallbackMap[callbackID] = callback;\n        }\n    }\n    onWindowMaximized(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onWindowMaximizeCallbackMap[callbackID];\n        } else {\n            this._onWindowMaximizeCallbackMap[callbackID] = callback;\n        }\n    }\n    onEntryNormal(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onEntryNormalCallbackMap[callbackID];\n        } else {\n            this._onEntryNormalCallbackMap[callbackID] = callback;\n        }\n    }\n}"],"mappings":"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"}