{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_ZegoRequestCoHostButton","_interopRequireDefault","_ZegoCancelRequestCoHostButton","_ZegoEndCoHostButton","_defines","_zegoUikitRn","_logger","_utils","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ZegoCoHostControlButton","props","hostID","liveStatus","isPluginsInit","memberConnectState","ZegoCoHostConnectState","idle","onConnectStateChanged","setIsToastVisable","setToastExtendedData","setIsDialogVisable","setDialogExtendedData","ZegoCoHostControlButtonType","request","cancel","end","coHostControlHandle","btnType","newConnectState","connecting","useEffect","callbackID","String","Math","floor","random","zloginfo","ZegoUIKit","getSignalingPlugin","onInvitationResponseTimeout","console","log","onInvitationAccepted","grantPermissions","error","turnCameraOn","turnMicrophoneOn","connected","onInvitationRefused","type","ZegoToastType","text","ZegoTranslationText","hostRejectCoHostRequestToast","createElement","View","style","styles","btnContainer","onRequestSuccessfully","bind","onCancelSuccessfully","onEndSuccessfully","StyleSheet","create"],"sources":["ZegoCoHostControlButton.tsx"],"sourcesContent":["import React, { useEffect } from \"react\";\nimport { StyleSheet, View } from \"react-native\"\nimport ZegoRequestCoHostButton from './ZegoRequestCoHostButton';\nimport ZegoCancelRequestCoHostButton from './ZegoCancelRequestCoHostButton';\nimport ZegoEndCoHostButton from './ZegoEndCoHostButton';\nimport { ZegoCoHostConnectState, ZegoToastType, ZegoTranslationText } from '../services/defines'\nimport ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport { zloginfo } from \"../utils/logger\";\nimport { grantPermissions } from '../utils';\n\nexport default function ZegoCoHostControlButton(props: any) {\n    const {\n        hostID,\n        liveStatus,\n        isPluginsInit,\n        memberConnectState = ZegoCoHostConnectState.idle,\n        onConnectStateChanged,\n        setIsToastVisable,\n        setToastExtendedData,\n        setIsDialogVisable,\n        setDialogExtendedData,\n    } = props;\n    const ZegoCoHostControlButtonType = {\n        request: 0,\n        cancel: 1,\n        end: 2,\n    };\n\n    const coHostControlHandle = (btnType: number) => {\n        let newConnectState = memberConnectState;\n        if (btnType === ZegoCoHostControlButtonType.request) {\n            newConnectState = ZegoCoHostConnectState.connecting;\n        } else if (btnType === ZegoCoHostControlButtonType.cancel) {\n            newConnectState = ZegoCoHostConnectState.idle;\n        } else if (btnType === ZegoCoHostControlButtonType.end) {\n            newConnectState = ZegoCoHostConnectState.idle;\n        }\n        onConnectStateChanged('', newConnectState);\n    };\n\n    useEffect(() => {\n        const callbackID = 'ZegoCoHostControlButton' + String(Math.floor(Math.random() * 10000));\n        if (isPluginsInit) {\n            // Plugins init success and register plugins callback\n            zloginfo('[ZegoCoHostControlButton]Plugins init success and register plugins callback');\n            ZegoUIKit.getSignalingPlugin().onInvitationResponseTimeout(callbackID, () => {\n                // The host did not process your cohost request, resulting in a timeout\n                console.log('#######onInvitationResponseTimeout, The host did not process your cohost request, resulting in a timeout');\n                onConnectStateChanged('', ZegoCoHostConnectState.idle, true);\n            });\n            ZegoUIKit.getSignalingPlugin().onInvitationAccepted(callbackID, async () => {\n                // The host accepted your cohost request\n                console.log('#######onInvitationAccepted, The host accepted your cohost request');\n                try {\n                    await grantPermissions();\n                } catch (error) {\n                }\n                ZegoUIKit.turnCameraOn('', true);\n                ZegoUIKit.turnMicrophoneOn('', true);\n                onConnectStateChanged('', ZegoCoHostConnectState.connected, true);\n            });\n            ZegoUIKit.getSignalingPlugin().onInvitationRefused(callbackID, () => {\n                // The host rejected your cohost request\n                console.log('#######onInvitationRefused, The host rejected your cohost request');\n                onConnectStateChanged('', ZegoCoHostConnectState.idle, true);\n                setIsToastVisable(true);\n                setToastExtendedData({ type: ZegoToastType.error, text: ZegoTranslationText.hostRejectCoHostRequestToast });\n            });\n        }\n        return () => {\n            if (isPluginsInit) {\n                ZegoUIKit.getSignalingPlugin().onInvitationResponseTimeout(callbackID);\n                ZegoUIKit.getSignalingPlugin().onInvitationAccepted(callbackID);\n                ZegoUIKit.getSignalingPlugin().onInvitationRefused(callbackID);\n            }\n        };\n    }, [isPluginsInit]);\n\n    return (\n        <View style={styles.btnContainer}>\n            {\n                memberConnectState === ZegoCoHostConnectState.idle ? <ZegoRequestCoHostButton\n                    hostID={hostID}\n                    liveStatus={liveStatus}\n                    // @ts-ignore\n                    onRequestSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.request)}\n                    setIsToastVisable={setIsToastVisable}\n                    setToastExtendedData={setToastExtendedData}\n                    \n                /> :\n                memberConnectState === ZegoCoHostConnectState.connecting ? <ZegoCancelRequestCoHostButton\n                    hostID={hostID}\n                    // @ts-ignore\n                    onCancelSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.cancel)}\n                    setIsToastVisable={setIsToastVisable}\n                    setToastExtendedData={setToastExtendedData}\n                /> :\n                memberConnectState === ZegoCoHostConnectState.connected ? <ZegoEndCoHostButton\n                    // @ts-ignore\n                    onEndSuccessfully={coHostControlHandle.bind(this, ZegoCoHostControlButtonType.end)}\n                    setIsDialogVisable={setIsDialogVisable}\n                    setDialogExtendedData={setDialogExtendedData}\n                /> :\n                null\n            }\n        </View>\n    )\n}\n\nconst styles = StyleSheet.create({\n    btnContainer: {},\n});\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,uBAAA,CAAAC,OAAA;AACA,IAAAC,YAAA,GAAAD,OAAA;AACA,IAAAE,wBAAA,GAAAC,sBAAA,CAAAH,OAAA;AACA,IAAAI,8BAAA,GAAAD,sBAAA,CAAAH,OAAA;AACA,IAAAK,oBAAA,GAAAF,sBAAA,CAAAH,OAAA;AACA,IAAAM,QAAA,GAAAN,OAAA;AACA,IAAAO,YAAA,GAAAJ,sBAAA,CAAAH,OAAA;AACA,IAAAQ,OAAA,GAAAR,OAAA;AACA,IAAAS,MAAA,GAAAT,OAAA;AAA4C,SAAAG,uBAAAO,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAf,wBAAAW,GAAA,EAAAI,WAAA,SAAAA,WAAA,IAAAJ,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAQ,KAAA,GAAAL,wBAAA,CAAAC,WAAA,OAAAI,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAT,GAAA,YAAAQ,KAAA,CAAAE,GAAA,CAAAV,GAAA,SAAAW,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAhB,GAAA,QAAAgB,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAnB,GAAA,EAAAgB,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAf,GAAA,EAAAgB,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAhB,GAAA,CAAAgB,GAAA,SAAAL,MAAA,CAAAT,OAAA,GAAAF,GAAA,MAAAQ,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAArB,GAAA,EAAAW,MAAA,YAAAA,MAAA;AAE7B,SAASW,uBAAuBA,CAACC,KAAU,EAAE;EACxD,MAAM;IACFC,MAAM;IACNC,UAAU;IACVC,aAAa;IACbC,kBAAkB,GAAGC,+BAAsB,CAACC,IAAI;IAChDC,qBAAqB;IACrBC,iBAAiB;IACjBC,oBAAoB;IACpBC,kBAAkB;IAClBC;EACJ,CAAC,GAAGX,KAAK;EACT,MAAMY,2BAA2B,GAAG;IAChCC,OAAO,EAAE,CAAC;IACVC,MAAM,EAAE,CAAC;IACTC,GAAG,EAAE;EACT,CAAC;EAED,MAAMC,mBAAmB,GAAIC,OAAe,IAAK;IAC7C,IAAIC,eAAe,GAAGd,kBAAkB;IACxC,IAAIa,OAAO,KAAKL,2BAA2B,CAACC,OAAO,EAAE;MACjDK,eAAe,GAAGb,+BAAsB,CAACc,UAAU;IACvD,CAAC,MAAM,IAAIF,OAAO,KAAKL,2BAA2B,CAACE,MAAM,EAAE;MACvDI,eAAe,GAAGb,+BAAsB,CAACC,IAAI;IACjD,CAAC,MAAM,IAAIW,OAAO,KAAKL,2BAA2B,CAACG,GAAG,EAAE;MACpDG,eAAe,GAAGb,+BAAsB,CAACC,IAAI;IACjD;IACAC,qBAAqB,CAAC,EAAE,EAAEW,eAAe,CAAC;EAC9C,CAAC;EAED,IAAAE,gBAAS,EAAC,MAAM;IACZ,MAAMC,UAAU,GAAG,yBAAyB,GAAGC,MAAM,CAACC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC;IACxF,IAAItB,aAAa,EAAE;MACf;MACA,IAAAuB,gBAAQ,EAAC,6EAA6E,CAAC;MACvFC,oBAAS,CAACC,kBAAkB,CAAC,CAAC,CAACC,2BAA2B,CAACR,UAAU,EAAE,MAAM;QACzE;QACAS,OAAO,CAACC,GAAG,CAAC,0GAA0G,CAAC;QACvHxB,qBAAqB,CAAC,EAAE,EAAEF,+BAAsB,CAACC,IAAI,EAAE,IAAI,CAAC;MAChE,CAAC,CAAC;MACFqB,oBAAS,CAACC,kBAAkB,CAAC,CAAC,CAACI,oBAAoB,CAACX,UAAU,EAAE,YAAY;QACxE;QACAS,OAAO,CAACC,GAAG,CAAC,oEAAoE,CAAC;QACjF,IAAI;UACA,MAAM,IAAAE,uBAAgB,EAAC,CAAC;QAC5B,CAAC,CAAC,OAAOC,KAAK,EAAE,CAChB;QACAP,oBAAS,CAACQ,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC;QAChCR,oBAAS,CAACS,gBAAgB,CAAC,EAAE,EAAE,IAAI,CAAC;QACpC7B,qBAAqB,CAAC,EAAE,EAAEF,+BAAsB,CAACgC,SAAS,EAAE,IAAI,CAAC;MACrE,CAAC,CAAC;MACFV,oBAAS,CAACC,kBAAkB,CAAC,CAAC,CAACU,mBAAmB,CAACjB,UAAU,EAAE,MAAM;QACjE;QACAS,OAAO,CAACC,GAAG,CAAC,mEAAmE,CAAC;QAChFxB,qBAAqB,CAAC,EAAE,EAAEF,+BAAsB,CAACC,IAAI,EAAE,IAAI,CAAC;QAC5DE,iBAAiB,CAAC,IAAI,CAAC;QACvBC,oBAAoB,CAAC;UAAE8B,IAAI,EAAEC,sBAAa,CAACN,KAAK;UAAEO,IAAI,EAAEC,4BAAmB,CAACC;QAA6B,CAAC,CAAC;MAC/G,CAAC,CAAC;IACN;IACA,OAAO,MAAM;MACT,IAAIxC,aAAa,EAAE;QACfwB,oBAAS,CAACC,kBAAkB,CAAC,CAAC,CAACC,2BAA2B,CAACR,UAAU,CAAC;QACtEM,oBAAS,CAACC,kBAAkB,CAAC,CAAC,CAACI,oBAAoB,CAACX,UAAU,CAAC;QAC/DM,oBAAS,CAACC,kBAAkB,CAAC,CAAC,CAACU,mBAAmB,CAACjB,UAAU,CAAC;MAClE;IACJ,CAAC;EACL,CAAC,EAAE,CAAClB,aAAa,CAAC,CAAC;EAEnB,oBACItC,MAAA,CAAAc,OAAA,CAAAiE,aAAA,CAAC5E,YAAA,CAAA6E,IAAI;IAACC,KAAK,EAAEC,MAAM,CAACC;EAAa,GAEzB5C,kBAAkB,KAAKC,+BAAsB,CAACC,IAAI,gBAAGzC,MAAA,CAAAc,OAAA,CAAAiE,aAAA,CAAC3E,wBAAA,CAAAU,OAAuB;IACzEsB,MAAM,EAAEA,MAAO;IACfC,UAAU,EAAEA;IACZ;IAAA;IACA+C,qBAAqB,EAAEjC,mBAAmB,CAACkC,IAAI,CAAC,IAAI,EAAEtC,2BAA2B,CAACC,OAAO,CAAE;IAC3FL,iBAAiB,EAAEA,iBAAkB;IACrCC,oBAAoB,EAAEA;EAAqB,CAE9C,CAAC,GACFL,kBAAkB,KAAKC,+BAAsB,CAACc,UAAU,gBAAGtD,MAAA,CAAAc,OAAA,CAAAiE,aAAA,CAACzE,8BAAA,CAAAQ,OAA6B;IACrFsB,MAAM,EAAEA;IACR;IAAA;IACAkD,oBAAoB,EAAEnC,mBAAmB,CAACkC,IAAI,CAAC,IAAI,EAAEtC,2BAA2B,CAACE,MAAM,CAAE;IACzFN,iBAAiB,EAAEA,iBAAkB;IACrCC,oBAAoB,EAAEA;EAAqB,CAC9C,CAAC,GACFL,kBAAkB,KAAKC,+BAAsB,CAACgC,SAAS,gBAAGxE,MAAA,CAAAc,OAAA,CAAAiE,aAAA,CAACxE,oBAAA,CAAAO;EACvD;EAAA;IACAyE,iBAAiB,EAAEpC,mBAAmB,CAACkC,IAAI,CAAC,IAAI,EAAEtC,2BAA2B,CAACG,GAAG,CAAE;IACnFL,kBAAkB,EAAEA,kBAAmB;IACvCC,qBAAqB,EAAEA;EAAsB,CAChD,CAAC,GACF,IAEF,CAAC;AAEf;AAEA,MAAMoC,MAAM,GAAGM,uBAAU,CAACC,MAAM,CAAC;EAC7BN,YAAY,EAAE,CAAC;AACnB,CAAC,CAAC"}