{"version":3,"names":["ZegoUIKit","PrebuiltHelper","MinimizingHelper","constructor","_defineProperty","getInstance","_instance","getIsMinimize","_isMinimize","setIsMinimizeSwitch","isMinimizeSwitch","_isMinimizeSwitch","getIsMinimizeSwitch","setInitParams","appID","appSign","userID","userName","roomID","config","arguments","length","undefined","_appInfo","_localUser","_roomID","Object","assign","_config","getInitAppInfo","getInitUser","getInitRoomID","getInitConfig","getInitPlugins","_plugins","minimizeWindow","callbackID","String","Math","floor","random","unRegisterAudioVideoListCallback","registerAudioVideoListCallback","notifyMinimize","startUpdateTimer","updateActiveUserIDByTimer","initUpdateTimer","clearInterval","_updateTimer","activeUserID","getRealTimeData","hostID","_activeUserID","getLocalUserInfo","notifyActiveUserIDUpdate","notifyPrebuiltInit","keys","_onPrebuiltInitCallbackMap","forEach","_onActiveUserIDUpdateCallbackMap","_onWindowMinimizeCallbackMap","notifyMaximize","_onWindowMaximizeCallbackMap","notifyEntryNormal","_onEntryNormalCallbackMap","onPrebuiltInit","callback","onActiveUserIDUpdate","onWindowMinimized","onWindowMaximized","onEntryNormal","_class"],"sources":["minimizing_helper.ts"],"sourcesContent":["import ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport PrebuiltHelper from \"./prebuilt_helper\";\n\nexport default class MinimizingHelper {\n    static _instance: MinimizingHelper;\n    _isMinimize = false;\n    _isMinimizeSwitch = false;\n    _activeUserID = '';\n    _onActiveUserIDUpdateCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onWindowMinimizeCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onWindowMaximizeCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _onEntryNormalCallbackMap: { [index: string]: (data?: any) => void } = {};\n    _updateTimer: null | NodeJS.Timeout = null;\n    _appInfo: {\n        appID?: number;\n        appSign?: String;\n    } = {};\n    _localUser: {\n        userID?: string;\n        userName?: string;\n    } = {};\n    _roomID = '';\n    _config: any = {};\n    _plugins: any[] = [];\n    _onPrebuiltInitCallbackMap: { [index: string]: (data?: any) => void } = {};\n    constructor() { }\n    static getInstance() {\n        return this._instance || (this._instance = new MinimizingHelper());\n    }\n    getIsMinimize() {\n        return this._isMinimize;\n    }\n    setIsMinimizeSwitch(isMinimizeSwitch: boolean) {\n        this._isMinimizeSwitch = !!isMinimizeSwitch;\n    }\n    getIsMinimizeSwitch() {\n        return this._isMinimizeSwitch;\n    }\n    setInitParams(appID: number, appSign: string, userID: string, userName: string, roomID: string, config = {}) {\n        this._appInfo = { appID, appSign };\n        this._localUser = { userID, userName };\n        this._roomID = roomID;\n        Object.assign(this._config, config);\n    }\n    getInitAppInfo() {\n        return this._appInfo;\n    }\n    getInitUser() {\n        return this._localUser;\n    }\n    getInitRoomID() {\n        return this._roomID;\n    }\n    getInitConfig() {\n        return this._config;\n    }\n    getInitPlugins() {\n        return this._plugins;\n    }\n    minimizeWindow() {\n        const callbackID = 'MinimizingHelper' + String(Math.floor(Math.random() * 10000));\n        this.unRegisterAudioVideoListCallback(callbackID);\n        this.registerAudioVideoListCallback(callbackID);\n\n        this.notifyMinimize();\n        this.startUpdateTimer();\n    }\n    startUpdateTimer() {\n        this.updateActiveUserIDByTimer();\n\n        this.initUpdateTimer();\n    }\n    initUpdateTimer() {\n        clearInterval(this._updateTimer);\n        this._updateTimer = null;\n    }\n    updateActiveUserIDByTimer() {\n        const activeUserID = PrebuiltHelper.getInstance().getRealTimeData().hostID;\n        this._activeUserID = activeUserID|| ZegoUIKit.getLocalUserInfo().userID || '';\n        \n        // console.log('[MinimizingHelper]updateActiveUserIDByTimer', this._activeUserID);\n        this.notifyActiveUserIDUpdate(this._activeUserID);\n    }\n    registerAudioVideoListCallback(callbackID: string) {\n    }\n    unRegisterAudioVideoListCallback(callbackID: string) {\n    }\n    notifyPrebuiltInit() {\n        Object.keys(this._onPrebuiltInitCallbackMap).forEach((callbackID) => {\n            if (this._onPrebuiltInitCallbackMap[callbackID]) {\n                this._onPrebuiltInitCallbackMap[callbackID]();\n            }\n        });\n    }\n    notifyActiveUserIDUpdate(activeUserID: string) {\n        Object.keys(this._onActiveUserIDUpdateCallbackMap).forEach((callbackID) => {\n            if (this._onActiveUserIDUpdateCallbackMap[callbackID]) {\n                this._onActiveUserIDUpdateCallbackMap[callbackID](activeUserID);\n            }\n        })\n    }\n    notifyMinimize() {\n        this._isMinimize = true;\n\n        Object.keys(this._onWindowMinimizeCallbackMap).forEach((callbackID) => {\n            if (this._onWindowMinimizeCallbackMap[callbackID]) {\n                this._onWindowMinimizeCallbackMap[callbackID]();\n            }\n        })\n    }\n    notifyMaximize() {\n        this._isMinimize = false;\n\n        Object.keys(this._onWindowMaximizeCallbackMap).forEach((callbackID) => {\n            if (this._onWindowMaximizeCallbackMap[callbackID]) {\n                this._onWindowMaximizeCallbackMap[callbackID]();\n            }\n        })\n    }\n    notifyEntryNormal() {\n        this._isMinimize = false;\n\n        Object.keys(this._onEntryNormalCallbackMap).forEach((callbackID) => {\n            if (this._onEntryNormalCallbackMap[callbackID]) {\n                this._onEntryNormalCallbackMap[callbackID]();\n            }\n        })\n    }\n    onPrebuiltInit(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onPrebuiltInitCallbackMap[callbackID];\n        } else {\n            this._onPrebuiltInitCallbackMap[callbackID] = callback;\n        }\n    }\n    onActiveUserIDUpdate(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onActiveUserIDUpdateCallbackMap[callbackID];\n        } else {\n            this._onActiveUserIDUpdateCallbackMap[callbackID] = callback;\n        }\n    }\n    onWindowMinimized(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onWindowMinimizeCallbackMap[callbackID];\n        } else {\n            this._onWindowMinimizeCallbackMap[callbackID] = callback;\n        }\n    }\n    onWindowMaximized(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onWindowMaximizeCallbackMap[callbackID];\n        } else {\n            this._onWindowMaximizeCallbackMap[callbackID] = callback;\n        }\n    }\n    onEntryNormal(callbackID: string, callback?: (data: any) => void) {\n        if (typeof callback !== 'function') {\n            delete this._onEntryNormalCallbackMap[callbackID];\n        } else {\n            this._onEntryNormalCallbackMap[callbackID] = callback;\n        }\n    }\n}"],"mappings":"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"}