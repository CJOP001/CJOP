{"version":3,"names":["React","useEffect","useRef","ZegoUIKit","StyleSheet","View","Text","TouchableOpacity","ZegoSendInvitationButton","ZegoTranslationText","ZegoInvitationType","ZegoToastType","ZegoCoHostMenuDialog","props","countdownMap","countdownTimerMap","visable","inviteeID","invitationType","inviteToCoHost","onCancel","onOk","setIsToastVisable","setToastExtendedData","resetTimer","inviteeCountdown","current","get","set","clearInterval","getCustomContainerStyle","create","customContainer","display","willPressedHandle","result","console","log","type","error","text","repeatInviteCoHostFailedToast","setInterval","getUser","inviteCoHostFailedToast","removeHandle","removeUserFromRoom","then","Map","Array","from","keys","forEach","key","createElement","style","styles","container","backgroundColor","width","height","fontSize","color","inviteCoHostButton","replace","removeCoHostButton","invitees","onWillPressed","onPressed","divide","removeButton","onPress","removeText","removeUserMenuDialogButton","cancelButton","cancelText","cancelMenuDialogButton","zIndex","position","bottom","borderTopLeftRadius","borderTopRightRadius","opacity","alignItems","justifyContent"],"sources":["ZegoCoHostMenuDialog.tsx"],"sourcesContent":["import React, { useEffect, useRef }from \"react\";\nimport ZegoUIKit from '@zegocloud/zego-uikit-rn';\nimport { StyleSheet, View, Text, TouchableOpacity } from \"react-native\";\nimport { ZegoSendInvitationButton } from '@zegocloud/zego-uikit-rn';\nimport { ZegoTranslationText, ZegoInvitationType, ZegoToastType } from \"../services/defines\";\n\n\nexport default function ZegoCoHostMenuDialog(props: any) {\n    const countdownMap = useRef();\n    const countdownTimerMap = useRef();\n    const {\n        visable,\n        inviteeID,\n        invitationType = ZegoInvitationType.inviteToCoHost,\n        onCancel,\n        onOk,\n        setIsToastVisable,\n        setToastExtendedData,\n        resetTimer,\n    } = props;\n\n    if (visable) {\n        const inviteeCountdown = (countdownMap.current as any).get(inviteeID);\n        if (!inviteeCountdown) {\n            (countdownMap.current as any).set(inviteeID, 60);\n        }\n    }\n    if (resetTimer) {\n        // Reset invitation timer\n        clearInterval((countdownTimerMap.current as any).get(inviteeID));\n        (countdownMap.current as any).set(inviteeID, 60);\n        (countdownTimerMap.current as any).set(inviteeID, null);\n    }\n\n    const getCustomContainerStyle = (visable: boolean) => StyleSheet.create({\n        customContainer: {\n            display: visable ? 'flex' : 'none',\n        },\n    });\n    // Verify whether invitations can be sent\n    const willPressedHandle = () => {\n        let result = true;\n        if (invitationType === ZegoInvitationType.inviteToCoHost) {\n            // Check whether the timer is running out\n            console.log('#########Timer: Check whether the timer is running out', countdownMap.current, countdownTimerMap.current);\n\n            if ((countdownTimerMap.current as any).get(inviteeID)) {\n                // The timer did not complete and the request was not allowed to occur\n                console.log('#########Timer: The timer did not complete and the request was not allowed to occur', countdownMap.current, countdownTimerMap.current);\n                setIsToastVisable(true);\n                setToastExtendedData({ type: ZegoToastType.error, text: ZegoTranslationText.repeatInviteCoHostFailedToast });\n                onCancel();\n                result = false;\n            } else {\n                // Restart timer\n                clearInterval((countdownTimerMap.current as any).get(inviteeID));\n                (countdownTimerMap.current as any).set(inviteeID ,setInterval(() => {\n                    console.log('#########Timer: countdown', countdownMap.current, countdownTimerMap.current);\n                    if ((countdownMap.current as any).get(inviteeID) === 0) {\n                        clearInterval((countdownTimerMap.current as any).get(inviteeID));\n                        (countdownTimerMap.current as any).set(inviteeID, null);\n                        (countdownMap.current as any).set(inviteeID, 60);\n                    } else {\n                        (countdownMap.current as any).set(inviteeID, (countdownMap.current as any).get(inviteeID) - 1);\n                    }\n                }, 1000));\n                if (!ZegoUIKit.getUser(inviteeID)) {\n                    result = false;\n                    setIsToastVisable(true);\n                    setToastExtendedData({ type: ZegoToastType.error, text: ZegoTranslationText.inviteCoHostFailedToast });\n                    onCancel();\n                }\n            }\n        }\n        return result;\n    }\n    const removeHandle = () => {\n        ZegoUIKit.removeUserFromRoom([inviteeID]).then(() => {\n            console.log(`remove ${inviteeID} from room successfully`);\n            // The handling here is the same as the cancel\n            onCancel();\n        });\n        \n    }\n\n    useEffect(() => {\n        // First render initializes and clears timer\n        console.log('#########Timer: First render initializes and clears timer', countdownMap.current, countdownTimerMap.current);\n        (countdownMap.current as any) = new Map();\n        (countdownTimerMap.current as any) = new Map();\n        return () => {\n            // Initializes and clears timer when component is destroyed\n            console.log('#########Timer: Initializes and clears timer when component is destroyed', countdownMap.current, countdownTimerMap.current);\n            Array.from((countdownTimerMap.current as any).keys()).forEach((key) => {\n                clearInterval((countdownTimerMap.current as any).get(key));\n                (countdownTimerMap.current as any).set(key, null);\n            });\n        };\n    }, []);\n\n    return <View style={[styles.container, getCustomContainerStyle(visable).customContainer]}>\n        <ZegoSendInvitationButton\n            backgroundColor={'transparent'}\n            width='100%'\n            height={50}\n            fontSize={14}\n            color='#fff'\n            text={\n                invitationType === ZegoInvitationType.inviteToCoHost ?\n                    ZegoTranslationText.inviteCoHostButton.replace('%0', inviteeID) :\n                    ZegoTranslationText.removeCoHostButton\n            }\n            invitees={[inviteeID]}\n            type={invitationType}\n            onWillPressed={willPressedHandle}\n            onPressed={onOk}\n        ></ZegoSendInvitationButton>\n        <View style={styles.divide}></View>\n        {/* remove xxx from the room */}\n        <TouchableOpacity style={styles.removeButton} onPress={removeHandle}>\n            <Text style={styles.removeText}>{ZegoTranslationText.removeUserMenuDialogButton.replace('%0', inviteeID)}</Text>\n        </TouchableOpacity>\n        <View style={styles.divide}></View>\n        <TouchableOpacity style={styles.cancelButton} onPress={onCancel}>\n            <Text style={styles.cancelText}>{ZegoTranslationText.cancelMenuDialogButton}</Text>\n        </TouchableOpacity>\n    </View>\n}\n \nconst styles = StyleSheet.create({\n    container: {\n        width: '100%',\n        zIndex: 12,\n        position: 'absolute',\n        bottom: 0,\n        borderTopLeftRadius: 16,\n        borderTopRightRadius: 16,\n        backgroundColor: 'rgba(17,16,20,0.9)',\n    },\n    divide: {\n        width: '100%',\n        height: 1,\n        backgroundColor: '#FFFFFF',\n        opacity: 0.1,\n    },\n    cancelButton: {\n        width: '100%',\n        height: 50,\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    cancelText: {\n        fontSize: 14,\n        color: '#fff',\n    },\n    removeButton: {\n        height: 50,\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    removeText: {\n        fontSize: 14,\n        color: '#fff',\n    },\n});"],"mappings":"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"}